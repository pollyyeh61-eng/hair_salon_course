<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å¤¢å¹»ç¾é«®å‰µæ¥­èª²ç¨‹</title>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        :root {
            --primary-purple: #8a2be2;
            --soft-purple: #b388ff;
            --deep-purple: #4b0082;
            --glass-bg: rgba(255, 255, 255, 0.9);
        }

        body {
            font-family: 'PingFang TC', 'Microsoft JhengHei', sans-serif;
            margin: 0;
            padding: 10px; /* æ‰‹æ©Ÿç‰ˆç•™ç™½ç¸®å° */
            background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            color: var(--deep-purple);
            min-height: 100vh;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .container {
            max-width: 900px;
            margin: 10px auto;
            background-color: var(--glass-bg);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        /* éŸ¿æ‡‰å¼ Header */
        .dashboard-header {
            display: flex;
            flex-direction: row;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap; /* è‡ªå‹•æ›è¡Œ */
            gap: 15px;
            padding-bottom: 20px;
            border-bottom: 2px dashed var(--soft-purple);
        }

        @media (max-width: 600px) {
            .dashboard-header { flex-direction: column; text-align: center; }
            .progress-info { width: 100%; display: flex; flex-direction: column; align-items: center; }
        }

        /* é€²åº¦æ¢æ¨£å¼ */
        .progress-bar-container {
            height: 12px;
            width: 100%;
            max-width: 200px;
            background-color: #ddd;
            border-radius: 10px;
            overflow: hidden;
            border: 1px solid #fff;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #ff8a00, #da1b60);
            width: 0%;
            transition: width 0.5s;
        }

        /* èª²ç¨‹å¡ç‰‡ RWD */
        .modules-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100%, 1fr)); /* æ‰‹æ©Ÿç‰ˆé è¨­ä¸€æ¬„ */
            gap: 15px;
            margin-top: 20px;
        }

        @media (min-width: 768px) {
            .modules-list { grid-template-columns: repeat(2, 1fr); } /* é›»è…¦ç‰ˆå…©æ¬„ */
        }

        .module-card {
            background: white;
            border-radius: 15px;
            padding: 15px;
            border-left: 6px solid var(--soft-purple);
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            cursor: pointer;
            transition: 0.3s;
        }

        .module-card:active { transform: scale(0.98); } /* æ‰‹æ©Ÿé»æ“Šåé¥‹ */

        /* å½±ç‰‡å®¹å™¨å„ªåŒ–ï¼š16:9 æ¯”ä¾‹ */
        .video-wrapper {
            position: relative;
            padding-bottom: 56.25%; /* 16:9 */
            height: 0;
            overflow: hidden;
            border-radius: 12px;
            background: #000;
            margin: 20px 0;
        }

        .video-wrapper iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }

        button {
            background: var(--primary-purple);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 25px;
            font-weight: bold;
            cursor: pointer;
        }

        .points-text { color: var(--primary-purple); font-weight: 900; font-size: 1.5em; }
    </style>
</head>
<body>

<div class="container">
    <div id="dashboard">
        <div class="dashboard-header">
            <div>
                <h2 style="margin:0;">âœ¨ <span id="userName">å‰µæ¥­å®¶</span></h2>
                <span id="userLevel" style="font-size: 0.9em; color: var(--primary-purple);">åˆéšå­¸å¾’</span>
            </div>
            <div class="progress-info">
                <div class="points-text"><span id="userPoints">0</span> PTS</div>
                <div class="progress-bar-container">
                    <div class="progress-bar" id="mainProgressBar"></div>
                </div>
            </div>
        </div>
        
        <div class="modules-list" id="modulesList"></div>
    </div>

    <div id="modulePage" style="display:none;">
        <button onclick="goBack()">â† è¿”å›åˆ—è¡¨</button>
        <h3 id="mTitle" style="margin-top:15px;"></h3>
        <div class="video-wrapper" id="videoContainer">
            </div>
        <button onclick="markAsComplete()" style="width: 100%; background: #28a745;">å®Œæˆæ­¤èª²ç¨‹ä¸¦é ˜å–é»æ•¸</button>
    </div>
</div>

<script>
    let state = {
        points: 0,
        modules: [
            { title: '0. ç‚ºä½•è¦å‰µæ¥­', url: 'https://drive.google.com/file/d/1gbZn2DTvHiE2B_G06nERXb-Q7AuQvFIh/preview', pts: 50, done: false },
            { title: '1. å¸‚å ´èª¿æŸ¥', url: 'https://drive.google.com/file/d/1U8qQb6Ob_0pLR-KxtTLDnYcuh0fqqFtW/preview', pts: 50, done: false },
            { title: '2. ç›®æ¨™å®¢ç¾¤åˆ†æ', url: 'https://drive.google.com/file/d/1K4_D47lq7gVnBl-OFApHuedFwgC3KAjV/preview', pts: 50, done: false },
            { title: '3. ç«¶çˆ­è€…ç ”ç©¶', url: 'https://drive.google.com/file/d/1O5YKOSNwJkiSZS_4sjJvEI0dwKD-CxnR/preview', pts: 50, done: false },
            { title: '4. è¡Œæ¥­è¶¨å‹¢è©•ä¼°', url: 'https://drive.google.com/file/d/1cC2envJ3VySRqNahyUsLbST1U5Nw-T2I/preview', pts: 50, done: false },
            { title: '5. å°ˆæ¥­ç¾é«®å®šä½', url: 'https://drive.google.com/file/d/1mx6dCQx22q7MVAMaiH3B5570xDGb8etg/preview', pts: 50, done: false },
            { title: '6. é¸å€èˆ‡ä½ˆç½®', url: 'https://drive.google.com/file/d/1kvB1EkXtp1xxtduubgPEPKtc_uJu7eK4/preview', pts: 50, done: false },
            { title: '7. æœå‹™å°ˆæ¡ˆ', url: 'https://drive.google.com/file/d/11M2Wpx8cTDlYxyzImPhtniOZUhLXtdiH/preview', pts: 50, done: false },
            { title: '8. ä¾›æ‡‰éˆç®¡ç†', url: 'https://drive.google.com/file/d/1Aj3GeAjIP561kZbvQ34erVizzbJ5GcZq/preview', pts: 100, done: false },
            { title: '9. äººåŠ›è³‡æºè¦åŠƒ', url: 'https://drive.google.com/file/d/16yrBQAjmQYj5fwOPvvZ5m8LRE287YWQ2/preview', pts: 50, done: false },
            { title: '10. é«˜ç«¯å®¢æˆ¶æœå‹™', url: 'https://drive.google.com/file/d/1kXaekwIciXsdwGy4pKnCyuMkohfOzvo_/preview', pts: 50, done: false },
            { title: '11. æ³•å¾‹èˆ‡åˆè¦', url: 'https://drive.google.com/file/d/1LmhYPbc-jUBJhtUWv11kIBoXy60yizrJ/preview', pts: 50, done: false },
            { title: '12. è²¡å‹™ç®¡ç†æµç¨‹', url: 'https://drive.google.com/file/d/18GQ8LguusbO7nKHRNl9dwdzFmRi1H-Be/preview', pts: 100, done: false },
            { title: '13. ä½æˆæœ¬å‰µæ¥­', url: 'https://drive.google.com/file/d/1gY-HmrC_qWmHTOJJ3vV_lnMiN32_RpEH/preview', pts: 100, done: false },
            { title: '14. ç²å®¢è®Šç¾', url: 'https://drive.google.com/file/d/1XWDIlKWw_ueGTIhfW8tld2KPp1jD_TBt/preview', pts: 100, done: false }
        ],
        cur: -1
    };

    function init() {
        const saved = localStorage.getItem('hair_biz_sim');
        if (saved) state = JSON.parse(saved);
        render();
    }

    function render() {
        document.getElementById('userPoints').textContent = state.points;
        const prog = (state.points / 1000) * 100;
        document.getElementById('mainProgressBar').style.width = prog + '%';

        const list = document.getElementById('modulesList');
        list.innerHTML = '';
        state.modules.forEach((m, i) => {
            const card = document.createElement('div');
            card.className = 'module-card';
            card.style.opacity = m.done ? '0.7' : '1';
            card.innerHTML = `
                <div style="display:flex; justify-content:space-between;">
                    <strong>${m.title}</strong>
                    <span>${m.done ? 'âœ…' : 'ğŸ’'}</span>
                </div>
                <div style="font-size:0.8em; margin-top:5px; color:var(--primary-purple);">çå‹µ: ${m.pts} é»</div>
            `;
            card.onclick = () => openMod(i);
            list.appendChild(card);
        });
        localStorage.setItem('hair_biz_sim', JSON.stringify(state));
    }

    function openMod(i) {
        state.cur = i;
        const m = state.modules[i];
        document.getElementById('mTitle').textContent = m.title;
        // é‡è¦ï¼šæ”¹ç”¨ iframe ç¢ºä¿ Google Drive é è¦½èƒ½è·‘
        document.getElementById('videoContainer').innerHTML = `<iframe src="${m.url}" allow="autoplay"></iframe>`;
        document.getElementById('dashboard').style.display = 'none';
        document.getElementById('modulePage').style.display = 'block';
        window.scrollTo(0,0);
    }

    function goBack() {
        document.getElementById('videoContainer').innerHTML = ''; // åœæ­¢å½±ç‰‡
        document.getElementById('dashboard').style.display = 'block';
        document.getElementById('modulePage').style.display = 'none';
    }

    function markAsComplete() {
        const m = state.modules[state.cur];
        if (!m.done) {
            m.done = true;
            state.points += m.pts;
            alert('æ­å–œç²å¾— ' + m.pts + ' é»ï¼');
        } else {
            alert('é€™å ‚èª²ä½ å·²ç¶“é ˜éé»æ•¸å›‰ï¼');
        }
        render();
        goBack();
    }

    init();
</script>

</body>
</html>
